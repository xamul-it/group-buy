(function(t){function e(e){for(var s,r,l=e[0],o=e[1],c=e[2],p=0,d=[];p<l.length;p++)r=l[p],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&d.push(n[r][0]),n[r]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],s=!0,l=1;l<a.length;l++){var o=a[l];0!==n[o]&&(s=!1)}s&&(i.splice(e--,1),t=r(r.s=a[0]))}return t}var s={},n={app:0},i=[];function r(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=s,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(a,s,function(e){return t[e]}.bind(null,s));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=o;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("a026"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"template"},[a("div",{staticClass:"container"},[a("div",{staticClass:"top-title clearfix"},[t._m(0),a("div",{staticClass:"buttons",attrs:{role:"group"}},[a("div",{staticClass:"btn-group",attrs:{dropdown:""}},[a("button",{staticClass:"btn btn-sm btn-success",attrs:{type:"button"},on:{click:function(e){t.showImportForm=!t.showImportForm}}},[a("i",{staticClass:"glyphicon glyphicon-th-list"}),t._v(" Carica nuovo")])])])]),a("div",{staticClass:"invoice"},[a("form",{attrs:{role:"form"}},[a("div",{staticClass:"row"},[a("keep-alive",[t.showImportForm?a("gb-vue-csv-import",{model:{value:t.csv,callback:function(e){t.csv=e},expression:"csv"}}):t._e()],1)],1),a("hr"),a("gb-vue-json-table",{attrs:{"table-headers":{description:"Descrizione",price:"Prezzo"}},model:{value:t.csv,callback:function(e){t.csv=e},expression:"csv"}})],1),a("div",{staticClass:"clearfix"}),a("hr")])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h1",{staticClass:"pull-left"},[t._v("Listino prezzi"),a("br")])}],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-12"},[a("h4",{staticClass:"mb-4"},[t._v("Importa il tuo listino da file CSV.")]),a("vue-csv-import",{attrs:{"map-fields":{description:"Descrizione",price:"Prezzo"},"can-ignore":!0,url:"/product/saveJsonList",buttonClass:"btn btn-primary",loadBtnText:"Carica file",ignoreOptionText:"Ignora",callback:t.csvCallback,catch:t.csvCatch,finally:t.csvFinally,"file-mime-types":["text/csv","text/x-csv","text/plain"]},scopedSlots:t._u([{key:"hasHeaders",fn:function(e){var s=e.headers,n=e.toggle;return[a("label",[a("input",{attrs:{type:"checkbox",id:"hasHeaders"},domProps:{value:s},on:{change:n}}),t._v(" Il file contiene una riga di intestazione? ")])]}},{key:"submit",fn:function(e){var s=e.submit;return[a("button",{staticClass:"btn btn-success",on:{click:function(t){return t.preventDefault(),s(t)}}},[t._v("Salva listino")])]}}]),model:{value:t.csv,callback:function(e){t.csv=e},expression:"csv"}},[a("template",{slot:"error"},[t._v(" File non valido ")]),a("template",{slot:"thead"},[a("tr",[a("th",[t._v("Campi listino")]),a("th",[t._v("Colonne da importare")])])])],2)],1)},l=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vue-csv-uploader"},[a("div",{staticClass:"form"},[a("div",{staticClass:"vue-csv-uploader-part-one"},[null===t.headers?a("div",{staticClass:"form-check form-group csv-import-checkbox"},[t._t("hasHeaders",[a("input",{class:t.checkboxClass,attrs:{type:"checkbox",id:t.makeId("hasHeaders")},domProps:{value:t.hasHeaders},on:{change:t.toggleHasHeaders}}),a("label",{staticClass:"form-check-label",attrs:{for:t.makeId("hasHeaders")}},[t._v(" File Has Headers ")])],{headers:t.hasHeaders,toggle:t.toggleHasHeaders})],2):t._e(),a("div",{staticClass:"form-group csv-import-file"},[a("input",{ref:"csv",class:t.inputClass,attrs:{type:"file",name:"csv",accept:t.fileMimeTypes},on:{change:function(e){return e.preventDefault(),t.validFileMimeType(e)}}}),t.showErrorMessage?t._t("error",[a("div",{staticClass:"invalid-feedback d-block"},[t._v(" File type is invalid ")])]):t._e()],2),a("div",{staticClass:"form-group"},[t._t("next",[a("button",{class:t.buttonClass,attrs:{type:"submit",disabled:t.disabledNextButton},on:{click:function(e){return e.preventDefault(),t.load(e)}}},[t._v(" "+t._s(t.loadBtnText)+" ")])],{load:t.load})],2)]),a("div",{staticClass:"vue-csv-uploader-part-two"},[t.sample?a("div",{staticClass:"vue-csv-mapping"},[a("table",{class:t.tableClass},[t._t("thead",[t._m(0)]),a("tbody",t._l(t.fieldsToMap,(function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(e.label))]),a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.map[e.key],expression:"map[field.key]"}],class:t.tableSelectClass,attrs:{name:"csv_uploader_map_"+s},on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.map,e.key,a.target.multiple?s:s[0])}}},[t.canIgnore?a("option",{domProps:{value:null}},[t._v(t._s(t.ignoreOptionText))]):t._e(),t._l(t.firstRow,(function(e,s){return a("option",{key:s,domProps:{value:s}},[t._v(t._s(e))])}))],2)])])})),0)],2),t.url?a("div",{staticClass:"form-group"},[t._t("submit",[a("input",{class:t.buttonClass,attrs:{type:"submit"},domProps:{value:t.submitBtnText},on:{click:function(e){return e.preventDefault(),t.submit(e)}}})],{submit:t.submit})],2):t._e()]):t._e()])])])},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("Field")]),a("th",[t._v("CSV Column")])])])}],u=(a("99af"),a("4160"),a("c975"),a("d81d"),a("b0c0"),a("d3b7"),a("159b"),a("2ef0")),p=a("bc3a"),d=a.n(p),f=a("369b"),v=a.n(f),h=a("cc1d"),m=a.n(h),b={props:{value:Array,url:{type:String},mapFields:{required:!0},callback:{type:Function,default:function(){return{}}},catch:{type:Function,default:function(){return{}}},finally:{type:Function,default:function(){return{}}},parseConfig:{type:Object,default:function(){return{}}},headers:{default:null},loadBtnText:{type:String,default:"Next"},ignoreOptionText:{type:String,default:"Ignore"},submitBtnText:{type:String,default:"Submit"},tableClass:{type:String,default:"table"},checkboxClass:{type:String,default:"form-check-input"},buttonClass:{type:String,default:"btn btn-primary"},inputClass:{type:String,default:"form-control-file"},validation:{type:Boolean,default:!0},fileMimeTypes:{type:Array,default:function(){return["text/csv","text/x-csv","text/plain"]}},tableSelectClass:{type:String,default:"form-control"},canIgnore:{type:Boolean,default:!1}},data:function(){return{form:{csv:null},fieldsToMap:[],map:{},hasHeaders:!0,csv:null,sample:null,isValidFileMimeType:!1,fileSelected:!1}},created:function(){this.hasHeaders=this.headers,Object(u["isArray"])(this.mapFields)?this.fieldsToMap=Object(u["map"])(this.mapFields,(function(t){return{key:t,label:t}})):this.fieldsToMap=Object(u["map"])(this.mapFields,(function(t,e){return{key:e,label:t}}))},methods:{submit:function(){var t=this;this.url&&d.a.post(this.url,this.form.csv).then((function(e){t.callback(e)})).catch((function(e){t.catch(e)})).finally((function(e){t.finally(e)}))},saveMappedCSVtoJson:function(){var t=this;this.form.csv=this.buildMappedCsv(),this.$emit("input",this.form.csv),t.callback(this.form.csv)},buildMappedCsv:function(){var t=this,e=this.hasHeaders?Object(u["drop"])(this.csv):this.csv;return Object(u["map"])(e,(function(e){var a={};return Object(u["forEach"])(t.map,(function(t,s){Object(u["set"])(a,s,Object(u["get"])(e,t))})),a}))},validFileMimeType:function(){var t=this.$refs.csv.files[0],e=""===t.type?m.a.lookup(t.name):t.type;console.log("Mime Type",e,t.type),this.isValidFileMimeType=!0},validateMimeType:function(t){return this.fileMimeTypes.indexOf(t)>-1},load:function(){var t=this;this.readFile((function(e){t.sample=Object(u["get"])(v.a.parse(e,{preview:2,skipEmptyLines:!0}),"data"),t.csv=Object(u["get"])(v.a.parse(e,{skipEmptyLines:!0}),"data")}))},readFile:function(t){var e=this.$refs.csv.files[0];if(e){var a=new FileReader;a.readAsText(e,"UTF-8"),a.onload=function(e){t(e.target.result)},a.onerror=function(){}}},toggleHasHeaders:function(){this.hasHeaders=!this.hasHeaders},makeId:function(t){return"".concat(t).concat(this._uid)}},watch:{map:{deep:!0,handler:function(t){var e=Object(u["isArray"])(this.mapFields)?Object(u["every"])(this.mapFields,(function(e){return t.hasOwnProperty(e)})):Object(u["every"])(this.mapFields,(function(e,a){return t.hasOwnProperty(a)}));e&&this.saveMappedCSVtoJson()}},hasHeaders:function(t,e){null!=this.csv&&this.saveMappedCSVtoJson()},sample:function(t,e){var a=this;null!==t&&this.fieldsToMap.forEach((function(e){t[0].forEach((function(t,s){e.key===t&&(a.map[e.key]=s)}))}))}},computed:{firstRow:function(){return Object(u["get"])(this,"sample.0")},showErrorMessage:function(){return this.fileSelected&&!this.isValidFileMimeType},disabledNextButton:function(){return!this.isValidFileMimeType}}},y=b,g=a("2877"),_=Object(g["a"])(y,o,c,!1,null,null,null),C=_.exports,k={components:{VueCsvImport:C},data:function(){return{csv:null}},methods:{csvCallback:function(t){console.log("csvCallback",t),this.$emit("input",this.csv)},csvCatch:function(t){console.log("csvCatch",t)},csvFinally:function(t){console.log("csvFinally",t)}}},x=k,O=Object(g["a"])(x,r,l,!1,null,null,null),M=O.exports,j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"gb-vue-json-table"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"form-group"},[a("p",{staticClass:"form-control-static"},[a("strong",[t._v("Listino ")]),t.limitOrMax>0?a("span",[t._v(" (prime "+t._s(t.limitOrMax)+" voci) ")]):t._e()])])])]),a("table",{staticClass:"table table-hover elenco"},[a("thead",[a("tr",[a("th",{staticClass:"col-sm-1"},[t._v("#")]),t._l(t.tableHeadersMap,(function(e,s){return a("th",{key:e.label,class:{"col-sm-1":s==t.tableHeadersMap.length-1,"col-sm-8":s!=t.tableHeadersMap.length-1}},[t._v(" "+t._s(e.label)+" ")])}))],2)]),a("tbody",t._l(t.json,(function(e,s){return a("tr",{key:s},[a("td",[t._v(" "+t._s(s+1))]),t._l(t.tableHeadersMap,(function(s,n){return a("td",{key:s.key,class:{"col-sm-1 text-right text-nowrap":n==t.tableHeadersMap.length-1}},[t._v(" "+t._s(t.formatTdText(e[s.key]))+" ")])}))],2)})),0)]),t.limit<10&&t.limitOrMax>0?a("a",{on:{click:function(e){t.limit=10}}},[t._v("Mostra altro")]):t._e()])},H=[],T=(a("fb6a"),{props:{value:Array,tableHeaders:{required:!0}},data:function(){return{tableHeadersMap:[],hasHeaders:!1,limit:2}},computed:{json:function(){return this.value?this.limit?this.value.slice(0,this.limit):this.value:[]},limitOrMax:function(){return this.value?this.limit<=this.value.length?this.limit:this.value.length:0}},methods:{formatTdText:function(t){return isNaN(t)?t:this.$root.$options.filters.currency(t)}},created:function(){this.hasHeaders=this.headers,Object(u["isArray"])(this.tableHeaders)?this.tableHeadersMap=Object(u["map"])(this.tableHeaders,(function(t){return{key:t,label:t}})):this.tableHeadersMap=Object(u["map"])(this.tableHeaders,(function(t,e){return{key:e,label:t}}))}}),F=T,w=(a("8efd"),Object(g["a"])(F,j,H,!1,null,null,null)),S=w.exports,P={components:{"gb-vue-csv-import":M,"gb-vue-json-table":S},data:function(){return{csv:null,showImportForm:!1}}},I=P,$=Object(g["a"])(I,n,i,!1,null,null,null),E=$.exports,V=a("f260");s["a"].config.productionTip=!1,s["a"].use(V["a"],{symbol:"€",thousandsSeparator:".",fractionCount:2,fractionSeparator:",",symbolPosition:"front",symbolSpacing:!0}),new s["a"]({render:function(t){return t(E)}}).$mount("#app")},"8efd":function(t,e,a){"use strict";var s=a("92fe"),n=a.n(s);n.a},"92fe":function(t,e,a){}});