(function(e){function t(t){for(var s,r,l=t[0],o=t[1],c=t[2],p=0,d=[];p<l.length;p++)r=l[p],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&d.push(n[r][0]),n[r]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],s=!0,l=1;l<a.length;l++){var o=a[l];0!==n[o]&&(s=!1)}s&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var s={},n={app:0},i=[];function r(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=s,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(a,s,function(t){return e[t]}.bind(null,s));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=o;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var s=a("3ebb"),n=a.n(s);n.a},"1f68":function(e,t,a){var s=a("7109");"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var n=a("499e").default;n("92afc2ec",s,!0,{sourceMap:!1,shadowMode:!1})},"3ebb":function(e,t,a){var s=a("e31a");"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var n=a("499e").default;n("517436b3",s,!0,{sourceMap:!1,shadowMode:!1})},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("a026"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"container"},[a("section",{staticClass:"py-5"},[a("div",{staticClass:"row mt-5"},[a("div",{staticClass:"col-8 offset-2"},[a("h4",{staticClass:"mb-4"},[e._v("Importa il tuo listino in formato CSV.")]),a("vue-csv-import",{attrs:{"map-fields":{description:"Descrizione",price:"Prezzo"},"can-ignore":!0,url:"/product/saveJsonList",buttonClass:"btn btn-primary",loadBtnText:"Carica",ignoreOptionText:"Ignora",callback:e.csvCallback,catch:e.csvCatch,finally:e.csvFinally,"file-mime-types":["text/csv","text/x-csv","text/plain"]},scopedSlots:e._u([{key:"hasHeaders",fn:function(t){var s=t.headers,n=t.toggle;return[a("label",[a("input",{attrs:{type:"checkbox",id:"hasHeaders"},domProps:{value:s},on:{change:n}}),e._v(" Il file contiene una riga di intestazione? ")])]}},{key:"submit",fn:function(t){var s=t.submit;return[a("button",{staticClass:"btn btn-success",on:{click:function(e){return e.preventDefault(),s(e)}}},[e._v("Invia")])]}}]),model:{value:e.csv,callback:function(t){e.csv=t},expression:"csv"}},[a("template",{slot:"error"},[e._v(" File non valido ")]),a("template",{slot:"thead"},[a("tr",[a("th",[e._v("Campi listino")]),a("th",[e._v("Colonne da importare")])])])],2),a("div",{staticClass:"mt-2"},[e._v(" "+e._s(e.csv)+" ")])],1)])])])])},i=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vue-csv-uploader"},[a("div",{staticClass:"form"},[a("div",{staticClass:"vue-csv-uploader-part-one"},[null===e.headers?a("div",{staticClass:"form-check form-group csv-import-checkbox"},[e._t("hasHeaders",[a("input",{class:e.checkboxClass,attrs:{type:"checkbox",id:e.makeId("hasHeaders")},domProps:{value:e.hasHeaders},on:{change:e.toggleHasHeaders}}),a("label",{staticClass:"form-check-label",attrs:{for:e.makeId("hasHeaders")}},[e._v(" File Has Headers ")])],{headers:e.hasHeaders,toggle:e.toggleHasHeaders})],2):e._e(),a("div",{staticClass:"form-group csv-import-file"},[a("input",{ref:"csv",class:e.inputClass,attrs:{type:"file",name:"csv"},on:{change:function(t){return t.preventDefault(),e.validFileMimeType(t)}}}),e.showErrorMessage?e._t("error",[a("div",{staticClass:"invalid-feedback d-block"},[e._v(" File type is invalid ")])]):e._e()],2),a("div",{staticClass:"form-group"},[e._t("next",[a("button",{class:e.buttonClass,attrs:{type:"submit",disabled:e.disabledNextButton},on:{click:function(t){return t.preventDefault(),e.load(t)}}},[e._v(" "+e._s(e.loadBtnText)+" ")])],{load:e.load})],2)]),a("div",{staticClass:"vue-csv-uploader-part-two"},[e.sample?a("div",{staticClass:"vue-csv-mapping"},[a("table",{class:e.tableClass},[e._t("thead",[e._m(0)]),a("tbody",e._l(e.fieldsToMap,(function(t,s){return a("tr",{key:s},[a("td",[e._v(e._s(t.label))]),a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.map[t.key],expression:"map[field.key]"}],class:e.tableSelectClass,attrs:{name:"csv_uploader_map_"+s},on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.map,t.key,a.target.multiple?s:s[0])}}},[e.canIgnore?a("option",{domProps:{value:null}},[e._v(e._s(e.ignoreOptionText))]):e._e(),e._l(e.firstRow,(function(t,s){return a("option",{key:s,domProps:{value:s}},[e._v(e._s(t))])}))],2)])])})),0)],2),e.url?a("div",{staticClass:"form-group"},[e._t("submit",[a("input",{class:e.buttonClass,attrs:{type:"submit"},domProps:{value:e.submitBtnText},on:{click:function(t){return t.preventDefault(),e.submit(t)}}})],{submit:e.submit})],2):e._e()]):e._e()])])])},l=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",[e._v("Field")]),a("th",[e._v("CSV Column")])])])}],o=(a("99af"),a("4160"),a("c975"),a("d81d"),a("b0c0"),a("d3b7"),a("159b"),a("2ef0")),c=a("bc3a"),u=a.n(c),p=a("369b"),d=a.n(p),f=a("cc1d"),v=a.n(f),h={props:{value:Array,url:{type:String},mapFields:{required:!0},mapFieldsNames:{required:!1},callback:{type:Function,default:function(){return{}}},catch:{type:Function,default:function(){return{}}},finally:{type:Function,default:function(){return{}}},parseConfig:{type:Object,default:function(){return{}}},headers:{default:null},loadBtnText:{type:String,default:"Next"},ignoreOptionText:{type:String,default:"Ignore"},submitBtnText:{type:String,default:"Submit"},tableClass:{type:String,default:"table"},checkboxClass:{type:String,default:"form-check-input"},buttonClass:{type:String,default:"btn btn-primary"},inputClass:{type:String,default:"form-control-file"},validation:{type:Boolean,default:!0},fileMimeTypes:{type:Array,default:function(){return["text/csv","text/x-csv","text/plain"]}},tableSelectClass:{type:String,default:"form-control"},canIgnore:{type:Boolean,default:!1}},data:function(){return{form:{csv:null},fieldsToMap:[],map:{},hasHeaders:!0,csv:null,sample:null,isValidFileMimeType:!1,fileSelected:!1}},created:function(){this.hasHeaders=this.headers,Object(o["isArray"])(this.mapFields)?this.fieldsToMap=Object(o["map"])(this.mapFields,(function(e){return{key:e,label:e}})):this.fieldsToMap=Object(o["map"])(this.mapFields,(function(e,t){return{key:t,label:e}}))},methods:{submit:function(){var e=this;this.url&&u.a.post(this.url,this.form.csv).then((function(t){e.callback(t)})).catch((function(t){e.catch(t)})).finally((function(t){e.finally(t)}))},saveMappedCsv:function(){var e=this;this.form.csv=this.buildMappedCsv(),this.$emit("input",this.form.csv),e.callback(this.form.csv)},buildMappedCsv:function(){var e=this,t=this.hasHeaders?Object(o["drop"])(this.csv):this.csv;return Object(o["map"])(t,(function(t){var a={};return Object(o["forEach"])(e.map,(function(e,s){Object(o["set"])(a,s,Object(o["get"])(t,e))})),a}))},validFileMimeType:function(){var e=this.$refs.csv.files[0],t=""===e.type?v.a.lookup(e.name):e.type;e?(this.fileSelected=!0,this.isValidFileMimeType=!this.validation||this.validateMimeType(t)):(this.isValidFileMimeType=!this.validation,this.fileSelected=!1)},validateMimeType:function(e){return this.fileMimeTypes.indexOf(e)>-1},load:function(){var e=this;this.readFile((function(t){e.sample=Object(o["get"])(d.a.parse(t,{preview:2,skipEmptyLines:!0}),"data"),e.csv=Object(o["get"])(d.a.parse(t,{skipEmptyLines:!0}),"data")}))},readFile:function(e){var t=this.$refs.csv.files[0];if(t){var a=new FileReader;a.readAsText(t,"UTF-8"),a.onload=function(t){e(t.target.result)},a.onerror=function(){}}},toggleHasHeaders:function(){this.hasHeaders=!this.hasHeaders},makeId:function(e){return"".concat(e).concat(this._uid)}},watch:{map:{deep:!0,handler:function(e){var t=Object(o["isArray"])(this.mapFields)?Object(o["every"])(this.mapFields,(function(t){return e.hasOwnProperty(t)})):Object(o["every"])(this.mapFields,(function(t,a){return e.hasOwnProperty(a)}));t&&this.saveMappedCsv()}},hasHeaders:function(e,t){console.log("hasHeaders",e,t),null!=this.csv&&this.saveMappedCsv()},sample:function(e,t){var a=this;null!==e&&this.fieldsToMap.forEach((function(t){e[0].forEach((function(e,s){t.key===e&&(a.map[t.key]=s)}))}))}},computed:{firstRow:function(){return Object(o["get"])(this,"sample.0")},showErrorMessage:function(){return this.fileSelected&&!this.isValidFileMimeType},disabledNextButton:function(){return!this.isValidFileMimeType}}},m=h,b=a("2877"),y=Object(b["a"])(m,r,l,!1,null,null,null),g=y.exports,_={name:"app",components:{VueCsvImport:g},data:function(){return{csv:null}},methods:{csvCallback:function(e){console.log("csvCallback",e)},csvCatch:function(e){console.log("csvCatch",e)},csvFinally:function(e){console.log("csvFinally",e)}}},C=_,x=(a("034f"),Object(b["a"])(C,n,i,!1,null,null,null)),k=x.exports,O=a("7d8b"),M=a.n(O);a("1f68"),s["default"].component("vue-csv-import",M.a),s["default"].config.productionTip=!1,new s["default"]({el:"#app",template:"<App/>",components:{App:k,VueCsvImport:M.a}})},7109:function(e,t,a){var s=a("24fb");t=s(!1),t.push([e.i,"",""]),e.exports=t},e31a:function(e,t,a){var s=a("24fb");t=s(!1),t.push([e.i,"#app{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:center;color:#2c3e50;margin-top:60px}.container{text-align:left}pre code{background-color:#eee;border:1px solid #999;display:block;padding:20px}#app .form{text-align:left}",""]),e.exports=t}});
//# sourceMappingURL=app.31182227.js.map